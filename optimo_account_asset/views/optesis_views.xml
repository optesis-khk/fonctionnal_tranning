<odoo>
    <data>

  <record model="ir.ui.view" id="optesis_asset_tree">
        <field name="priority" eval="15"/>
        <field name="name">optesis.asset.tree</field>
        <field name="model">account.asset.asset</field>
        <field name="arch" type="xml">
            <tree string="asset_list">
                <field name="product_id"/>
                <field name="category_id"/>
                <field name="code_bar"/>
                <field name="condition" />
                <field name="brand"/>
                <field name="site" />
                <field name="room"/>
                <field name="direction"/>
                <field name="department"/>
                <field name="service"/>
                <field name="inventory_date"/>
                <field name="last"/>
                <field name="state"/>
            </tree>
        </field>
    </record>


        <record model="ir.ui.view" id="optesis_asset_form">
            <field name="priority" eval="15"/>
            <field name="name">optesis.asset.form</field>
            <field name="model">account.asset.asset</field>
            <field name="arch" type="xml">

            <form>
                 <header>
                    <button name="validate" states="draft" string="Confirm Asset" type="object" class="oe_highlight"/>
                    <button name="set_to_close" states="open" string="Set to Close" type="object" class="oe_highlight"/>
                    <button name="set_to_draft" states="open" string="Set to Draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,open"/>
                </header>
                 <sheet string="New Asset">
                      <separator string="New Asset"/>
                     <group>
                           <group>
                               <div class="oe_title">
                         <label for="code_bar" class="oe_edit_only"/> <br/>
                         <h1 onkeyup="test_key(event)" type="object" name="asset_renew" id="code"> <field name="code_bar" default_focus="1" class="oe_inline bar" required="True"/>  </h1>

                                    <script>
                                        var i = 0;
                                        function test_key(event){
                                            var but = document.getElementById("asset_renew");

                                             if (event.keyCode == 45){
                                                 this.write;
                                    	         jQuery('footer button:last').click();
                                                 //$("#code").click();
                                                 i = i+1;
                                                 console.log(window.location.href);
                                                 //console.log(window.form.length);
                                        //ass = new odoo.web.Model('account.asset.asset');
                                        //ass.create;
                                        }
                                        }
                                     </script>

                     </div>

                         </group>
                         <group>
                              <div class="oe_title">
                         <label for="product_id" class="oe_edit_only"/> <br/>
                        <h1> <field name="product_id" class="oe_inline" required="True"/> </h1>
                     </div>
                         </group>
                     </group>
                     <group>
                     <group>
                         <!-- <field name="direction"/>
                         <field name="department" domain="[('direction_id', '=', direction)]"/>
                         <field name="service" domain="[('department_id', '=', department)]"/>
                         <field name="agents" domain="[('service', '=', service)]"/> -->
                         <field name="service" required="True" />
                         <field name="department" required="True"/>
                         <field name="direction" required="True"/>
                         <field name="agents" domain="[('service', '=', service)]"/>
                     </group>

                      <group>
                         <field name="site" required="True"/>
                         <field name="building"  domain="[('site_id', '=', site)]" required="True"/>
                         <field name="level"  domain="[('building_id', '=', building)]" required="True"/>
                         <field name="room"  domain="[('level_id', '=', level)]" required="True"/>
                     </group>
                     </group>

                     <group>
                    <group>
                        <field name="condition" required="True"/>
                        <field name="brand"/>
                        <field name="specifications"/>
                </group>
                <group>
                        <field name="category_id" required="True"/>
                        <field name="inventory_date"/>
                        <field name="last"  invisible='1'/>
                        <field name="date"/>
                        <field name="asset_number"/>

                </group>
                    <notebook colspan="4">
                     <page string="General">
                            <group>
                                <group>
                                    <field name="value" widget="monetary" options="{'currency_field': 'currency_id'}" />
                                    <field name="salvage_value" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="value_residual" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="partner_id"/>


                                </group>
                                <group>
                                    <field name="method"/>
                                    <field name="method_progress_factor" attrs="{'invisible':[('method','=','linear')], 'required':[('method','=','degressive')]}"/>
                                    <label for="method_time"/>

                                    <div>
                                        <field name="method_time" class="oe_inline"/>

                                    </div>
                                    <field name="prorata" attrs="{'invisible': [('method_time','=','end')]}"/>
                                    <field name="method_number" attrs="{'invisible':[('method_time','=','end')], 'required':[('method_time','=','number')]}"/>
                                    <field name="method_period"/>
                                    <field name="method_end" attrs="{'required': [('method_time','=','end')], 'invisible':[('method_time','=','number')]}"/>
                                </group>
                            </group>
                        </page>
                        <page string="Depreciation Board" groups="base.group_erp_manager">
                            <field name="depreciation_line_ids" mode="tree">
                                <tree string="Depreciation Lines" colors="blue:(move_check == False);black:(move_check == True)">
                                    <field name="depreciation_date"/>
                                    <field name="sequence" invisible="1"/>
                                    <field name="depreciated_value" readonly="1"/>
                                    <field name="amount"/>
                                    <field name="remaining_value" readonly="1"/>
                                    <field name="move_check"/>
                                    <field name="parent_state" invisible="1"/>
                                    <button name="create_move" attrs="{'invisible':['|',('move_check','!=',False),('parent_state','!=','open')]}" icon="gtk-execute" string="Create Move" type="object"/>
                                </tree>
                                <form string="Depreciation Lines">
                                    <group>
                                        <group>
                                            <field name="parent_state" invisible="1"/>
                                            <field name="name"/>
                                            <field name="amount"/>
                                            <field name="move_id"/>
                                            <field name="move_check"/>
                                            <field name="parent_state" invisible="1"/>
                                        </group>
                                        <group>
                                            <field name="sequence"/>
                                            <field name="depreciation_date"/>
                                            <field name="depreciated_value"/>
                                            <field name="remaining_value"/>
                                        </group>
                                    </group>
                                </form>
                            </field>
                            <button type="object" name="compute_depreciation_board" string="Compute" icon="terp-stock_format-scientific" colspan="2" attrs="{'invisible':[('state','=','close')]}"/>
                        </page>
                        <!-- <page string="History" groups="base.group_erp_manager">
                            <field name="account_move_line_ids" readonly="1"/>
                            <field name="history_ids" readonly="1"/>
                        </page> -->
                        <page string="Notes">
                            <field name="note" placeholder="Add an internal note here..."/>
                        </page>
                         <page string="Disposal" groups="base.group_erp_manager">
                             <group>
                                 <group>
                                     <field name="date_disposal"/>
                                     <field name="num_facture_vente"/>
                                     <field name="type_disposal"/>
                                 </group>
                                 <group>
                                     <field name="value_disposal"/>
                                     <field name="buyer"/>
                                     <field name="est_amortie"/>
                                 </group>
                             </group>
                        </page>
                        <page string="Historique">
                            <field name="log_ids" readonly="1">
                                <tree>
                                    <field name="date"/>
                                    <field name="description"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                     </group>
                     <!--<button  type="object" name="write" string="Save" />-->
                     <footer>
                         <button  type="object" string="Save and new" name="asset_renew" id="but" />
                         <!-- <button name="cancel" string="Cancel" special="cancel" class="oe_link"/> -->
                     </footer>
                 </sheet>
            </form>
        </field>
    </record>


         <!-- <record model="ir.ui.view" id="family_tree">
        <field name="name">optesis.family.tree</field>
        <field name="model">optesis.family</field>
        <field name="arch" type="xml">
            <tree string="Famille d'immobilisation">
                <field name="name"/>
                <field name="category_id"/>

            </tree>
        </field>
    </record>

      <record model="ir.ui.view" id="family_form">
        <field name="name">optesis.family.form</field>
        <field name="model">optesis.family</field>
        <field name="arch" type="xml">
            <form >
                <sheet string="Famille d'immobilisation">
                    <group>
                        <group>
                            <field name="name"/>
                            <field name="category_id"/>
                        </group>
                    </group>
                </sheet>

            </form>
        </field>
    </record> -->

        <record model="ir.ui.view" id="condition_tree">
        <field name="name">condition.tree</field>
        <field name="model">optesis.condition</field>
        <field name="arch" type="xml">
            <tree string="condition_list">
                <field name="name"/>
                <field name="description"/>
            </tree>
        </field>
    </record>

        <record model="ir.ui.view" id="condition_form">
        <field name="name">condition.form</field>
        <field name="model">optesis.condition</field>
        <field name="arch" type="xml">
            <form string="condition_form">
                <sheet>
                <group colspan="4">
                    <group colspan="2" rowspan="2" string="Condition">
                        <field name="name" />
                        <field name="description" />
                    </group>
                </group>
                 </sheet>
            </form>
        </field>
    </record>

        <!-- <record model="ir.ui.view" id="article_tree">
        <field name="name">article.tree</field>
        <field name="model">optesis.product</field>
        <field name="arch" type="xml">
            <tree string="article_list">
                <field name="name"/>
                <field name="description"/>
                <field name="category_id" />
                <field name="price"/>
            </tree>
        </field>
    </record> -->

        <!-- <record model="ir.ui.view" id="article_form">
        <field name="priority" eval="5" />
        <field name="name">article.form</field>
        <field name="model">optesis.product</field>
        <field name="arch" type="xml">
            <form string="article_form">
                 <sheet string="Standard des Immobilisations">
                <group colspan="4">
                    <group>
                        <field name="name" />
                        <field name="category_id"/>
                    </group>
                    <group>
                        <field name="description" />
                        <field name="price" />
                    </group>
                </group>
                 </sheet>
            </form>
        </field>
    </record> -->

         <record model="ir.ui.view" id="asset_seacrh_view">
             <field name="priority" eval="1"/>
            <field name="name">optesis.asset.search</field>
            <field name="model">account.asset.asset</field>
            <field name="arch" type="xml">
                <search>
                    <group expand="0" string="group_by">
                        <filter name='group_category_id' string="Category" context="{'group_by':'category_id'}" />
                        <filter name='group_product' string="Product" context="{'group_by':'product_id'}"/>
                        <filter name='group_direction' string="Direction" context="{'group_by':'direction'}"/>
                        <filter name='group_service' string="Service" context="{'group_by':'service'}" />
                        <filter name='group_site' string="Site" context="{'group_by':'site'}" />
                        <filter name='group_room' string="Room" context="{'group_by':'room'}" />
                    </group>
                    <field name="product_id"/>
                    <field name="code_bar"/>
                    <field name="brand"/>
                    <field name="category_id" />
                    <field name="direction" />
                    <field name="department"/>
                    <field name="service"/>
                    <field name="site" />
                    <field name="building"/>
                    <field name="level" />
                    <field name="room" />
                    <field name="date_assignation" />
                </search>
            </field>
         </record>

         <record model="ir.ui.view" id="condition_form">
            <field name="name">control.form</field>
            <field name="model">optesis.control</field>
            <field name="arch" type="xml">
                <form string="Controle des inventaires">
                   <header>
                       <button name="start_control" string="Commencer" type="object" class="oe_highlight" states="draft"/>
                       <button name="validate_control" string="Valider" type="object" class="oe_highlight" states="open"/>
                       <field name="state" widget="statusbar" statusbar_visible="draft,open,end"/>
                   </header>
                   <sheet>
                    <group>
                        <group>
                            <field name="site_id" />
                            <field name="level_id" domain="[('building_id', '=', building_id)]" required="True"/>
                            <field name="service_id" required="True"/>
                        </group>
                        <group>
                            <field name="building_id" domain="[('site_id', '=', site_id)]" required="True"/>
                            <field name="room_id" domain="[('level_id', '=', level_id)]" required="True"/>
                            <field name="condition_id" required="True"/>
                        </group>
                    </group>
                    <div class="oe_title">
                        <label for="code_barre" class="oe_edit_only"/> <br/>
                        <h1 onkeyup="get_code(event)" type="object" name="change_code_barre">
                            <field name="code_barre" class="oe_inline bar" placeholder="Recherche du code barre" default_focus="1" attrs="{'invisible':[('state', '!=', 'open')]}"/>  </h1>
                            <script>
                                var i = 0;
                                function get_code(event){
                                if (event.keyCode == 45){
                                jQuery('footer button:last').click();

                                }
                                }
                            </script>

                        </div>

                        <!-- <field name="code_barre" placeholder="Saisie du code barre" attrs="{'invisible':[('state', '!=', 'open')]}"/> -->
                        <notebook>
                            <page string="inventaire" attrs="{'invisible':[('state', '=', 'draft')]}">
                                <field name="asset_ids" attrs="{'readonly':[('state','=','end')]}">

                                </field>
                            </page>
                        </notebook>
                        <footer>
                           <button  type="object" string="verifier" name="change_code_barre" id="check" invisible="1"/>
                       </footer>
                   </sheet>
               </form>
           </field>
       </record>





        <act_window id="win001" name="Inventaires" res_model="account.asset.asset" view_mode="tree,form" />
        <menuitem id="asset_menu_0" name="Optimo Account Asset" web_icon="optimo_account_asset,static/description/icon.png" sequence="100"/>


        <menuitem id="asset_menu_1" name="Menu Général" parent="asset_menu_0" sequence="1"/>
        <menuitem id="asset_menu_5" name="Catalogues" parent="asset_menu_0" sequence="2"/>
        <menuitem id="asset_menu_3" name="Organisation" parent="asset_menu_0" sequence="3"/>
        <menuitem id="asset_menu_4" name="Sites" parent="asset_menu_0" sequence="9"/>

        <menuitem id="asset_menu_2" name="Inventaire" parent="asset_menu_1" action="win001" sequence="2"/>

        <act_window id="win011" name="Categories" res_model="account.asset.category" view_mode="tree,form"/>
        <menuitem id="category_menu_2" name="Categories" parent="asset_menu_5" action="win011" sequence="14"/>


        <act_window id="win014" name="Standards" res_model="product.template" view_mode="tree,form"/>
        <menuitem id="article_menu_2" name="Standards" parent="asset_menu_5" action="win014" sequence="17"/>

        <act_window id="win015" name="États" res_model="optesis.condition" view_mode="tree,form"/>
        <menuitem id="condition_menu_2" name="États" parent="asset_menu_5" action="win015" sequence="18"/>

        <act_window id="win_inv_100" name="Controle" res_model="optesis.control" view_mode="tree,form" />
        <menuitem id="asset_menu_controle" name="Controle inventaire" parent="asset_menu_1" action="win_inv_100" sequence="19"/>
    </data>
</odoo>
